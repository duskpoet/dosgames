{"version":3,"sources":["app/core.cljs"],"mappings":"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","names":["app.core/controls-scheme","app.core/setup-keys","ci","controls","seq__43863","cljs.core/seq","chunk__43875","count__43876","i__43877","temp__5735__auto__","cljs.core/chunked-seq?","c__4609__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","cljs.core/first","cljs.core/next","c","map__43912","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","map__43923","id","code","el","goog.dom/getElement","G__43914","G__43915","G__43916","G__43925","G__43926","G__43927","goog.events/listen","goog.events/EventType.POINTERDOWN","G__43917","G__43918","G__43919","G__43928","G__43929","G__43930","goog.events/EventType.POINTERUP","app.core/fullscreen","goog.dom.fullscreen/requestFullScreen","app.core/listen-fullscreen","btn","app.core/process-ci","app.core/on-ready","fs","main","p1","p2","G__43939","app.core/launch","runner","js/Dos","app.core/main!"],"sourcesContent":["(ns app.core\n  (:require\n   [\"js-dos\"]\n   [goog.dom :as dom]\n   [goog.dom.fullscreen :refer [requestFullScreen]]\n   [goog.events :as events]))\n\n(def controls-scheme\n  [{:id \"left\"\n    :code 37}\n\n   {:id \"right\"\n    :code 39}\n\n   {:id \"up\"\n    :code 38}\n\n   {:id \"down\"\n    :code 40}\n\n   {:id \"space\"\n    :code 32}\n\n   {:id \"enter\"\n    :code 13}])\n\n(defn setup-keys [ci controls]\n  (doseq [c controls]\n    (let [{:keys [id code]} c\n          el (dom/getElement id)]\n      (events/listen\n       el\n       events/EventType.POINTERDOWN\n       #(.simulateKeyEvent ci code true))\n      (events/listen\n       el\n       events/EventType.POINTERUP\n       #(.simulateKeyEvent ci code false)))))\n\n(defn fullscreen []\n  (let [el (dom/getElement \"player-container\")]\n    (requestFullScreen el)))\n\n(defn listen-fullscreen []\n  (let [btn (dom/getElement \"fullscreen\")]\n    (events/listen btn \"click\" fullscreen)))\n\n(defn process-ci [ci]\n  (setup-keys ci controls-scheme))\n\n(defn on-ready [fs, main]\n  (let [p1 (.extract fs \"chip.zip\")\n        p2 (.then p1 #(main #js [\"-c\" \"CHIPS.EXE\"]))]\n    (.then p2 process-ci)\n    (listen-fullscreen)))\n\n(defn launch []\n  (let [el (dom/getElement \"playerbox\")\n        runner (js/Dos el)]\n    (.ready runner on-ready)))\n\n(defn main! []\n  (launch))\n"]}